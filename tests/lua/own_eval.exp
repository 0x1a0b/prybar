#!/usr/bin/expect -f

set timeout -1
spawn ./prybar-lua -I
match_max 100000
expect -exact "Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio\r
--> "
send -- "1"
expect -exact "\r--> 1\[0K\r\[5C"
send -- "+"
expect -exact "\r--> 1+\[0K\r\[6C"
send -- "1"
expect -exact "\r--> 1+1\[0K\r\[7C"
send -- "\r"
expect -exact "\r--> 1+1\[0K\r\[7C\r
lua: \[string \"<eval>\"\]:1: unexpected symbol near '1'\r
--> "
send -- "r"
expect -exact "\r--> r\[0K\r\[5C"
send -- "e"
expect -exact "\r--> re\[0K\r\[6C"
send -- "t"
expect -exact "\r--> ret\[0K\r\[7C"
send -- "u"
expect -exact "\r--> retu\[0K\r\[8C"
send -- "r"
expect -exact "\r--> retur\[0K\r\[9C"
send -- "n"
expect -exact "\r--> return\[0K\r\[10C"
send -- " "
expect -exact "\r--> return \[0K\r\[11C"
send -- "1"
expect -exact "\r--> return 1\[0K\r\[12C"
send -- "\r"
expect -exact "\r--> return 1\[0K\r\[12C\r
--> "
send -- "a"
expect -exact "\r--> a\[0K\r\[5C"
send -- " "
expect -exact "\r--> a \[0K\r\[6C"
send -- ""
expect -exact "\r--> a\[0K\r\[5C"
send -- "="
expect -exact "\r--> a=\[0K\r\[6C"
send -- "1"
expect -exact "\r--> a=1\[0K\r\[7C"
send -- "\r"
expect -exact "\r--> a=1\[0K\r\[7C\r
--> "
send -- ""
expect eof
